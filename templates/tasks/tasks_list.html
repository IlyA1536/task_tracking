{% extends "base.html" %}
{% block content %}
{% load i18n %}
    <a href="{% url 'tasks:task-create' %}">{% trans "Create task" %}</a>
    <form method="get" id="SortForm">
        {% csrf_token %}
        <label class="form-label" for="status">{% trans "Status" %}:</label>
        <select name="status" id="StatusSelect">
            <option value="" {% if form.status.value == '' %} selected {% endif %}>{% trans "All" %}</option>
            <option value="todo" {% if form.status.value == 'todo' %} selected {% endif %}>{% trans "To do" %}</option>
            <option value="in_progress" {% if form.status.value == 'in_progress' %} selected {% endif %}>{% trans "In progress" %}</option>
            <option value="done" {% if form.status.value == 'done' %} selected {% endif %}>{% trans "Done" %}</option>
        </select>

        <label class="form-label" for="priority">{% trans "Priority" %}:</label>
        <select name="priority" id="PrioritySelect">
            <option value="" {% if form.priority.value == '' %} selected {% endif %}>{% trans "All" %}</option>
            <option value="low" {% if form.priority.value == 'low' %} selected {% endif %}>{% trans "Low" %}</option>
            <option value="medium" {% if form.priority.value == 'medium' %} selected {% endif %}>{% trans "Medium" %}</option>
            <option value="high" {% if form.priority.value == 'high' %} selected {% endif %}>{% trans "High" %}</option>
        </select>
    </form>
    <script>
        document.getElementById("StatusSelect").addEventListener("change", function() {
            document.getElementById("SortForm").submit();
        });
        document.getElementById("PrioritySelect").addEventListener("change", function() {
            document.getElementById("SortForm").submit();
        });
    </script>

    <ul>
        {% for task in tasks %}
        <li>
            <a href="{% url 'tasks:task-detail' task.id %}"> {{ task.title }}</a>
            <span>{% trans task.status %}</span>
            <span> {{ task.priority }}</span>
        </li>
        <form action="{% url 'tasks:task-complete' task.pk %}" method="post">
            {% csrf_token %}
            <button type='submit'>{% trans "Complete" %}</button>
        </form>
        {% endfor %}
    </ul>
{% endblock %}
